---
import Countdown from "../components/Countdown.jsx";
import QuoteTicker from "../components/QuoteTicker.jsx";
import "../styles/global.css";

const targetDate = "2025-02-14T17:00:00";
const quittingMessage = "Dropping my keyboard at 5:00 PM, never to be paged again.";
const sarcasticNotes = [
  "Yes, I already updated the docs. You're welcome.",
  "No, I will not fix the legacy jQuery modal.",
  "Remember me when the CI pipeline flakes again.",
  "I left a TODO that says: 'Ask future you'.",
  "Sure, I'll join the postmortem... in spirit.",
];
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Countdown to My Great Escape</title>
  </head>
  <body>
    <main class="page">
      <section class="hero">
        <div class="hero-top">
          <p class="eyebrow">To my favorite bug wranglers</p>
          <button class="theme-toggle" type="button" data-theme-toggle>
            Switch theme
          </button>
        </div>
        <h1>Countdown to my glorious resignation</h1>
        <p class="subhead">
          {quittingMessage}
          <span class="spark">âœ¨</span>
        </p>
      </section>

      <section class="countdown-panel">
        <Countdown client:load targetDate={targetDate} />
      </section>

      <section class="ticker-panel">
        <h2>Gentle reminders for the team</h2>
        <QuoteTicker client:load notes={sarcasticNotes} />
      </section>

      <section class="footer">
        <p>
          Hosting this on Netlify so you can keep watching the clock long after my
          Slack avatar disappears.
        </p>
      </section>
    </main>
  </body>
  <script>
    const root = document.documentElement;
    const toggle = document.querySelector("[data-theme-toggle]");
    const storedTheme = localStorage.getItem("theme");
    const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
    const defaultTheme = storedTheme ?? (prefersDark ? "dark" : "light");

    root.dataset.theme = defaultTheme;

    const updateLabel = () => {
      const next = root.dataset.theme === "dark" ? "Light mode" : "Dark mode";
      toggle.textContent = `Switch to ${next}`;
      toggle.setAttribute("aria-pressed", root.dataset.theme === "dark");
    };

    updateLabel();

    toggle.addEventListener("click", () => {
      root.dataset.theme = root.dataset.theme === "dark" ? "light" : "dark";
      localStorage.setItem("theme", root.dataset.theme);
      updateLabel();
    });
  </script>
</html>
